<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: Rails::Generator::Commands::Destroy [Rails Framework Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          Rails::Generator::Commands::Destroy
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../../files/vendor/rails/railties/lib/rails_generator/commands_rb.html">vendor/rails/railties/lib/rails_generator/commands.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="RewindBase.html">Rails::Generator::Commands::RewindBase</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            Undo the actions performed by a generator. Rewind the action manifest and
            attempt to completely erase the results of each action.
            </p>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M002703">complex_template</a></li>
              <li><a href="#M002702">directory</a></li>
              <li><a href="#M002700">file</a></li>
              <li><a href="#M002704">migration_template</a></li>
              <li><a href="#M002705">route_resources</a></li>
              <li><a href="#M002701">template</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M002703'>
                <a name='M002703'></a>
                <div class='synopsis'>
                  <span class='name'>complex_template</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002703-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002703-source'>     <span class="ruby-comment cmt"># File vendor/rails/railties/lib/rails_generator/commands.rb, line 514</span>&#x000A;514:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">complex_template</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;515:           <span class="ruby-comment cmt"># nothing should be done here</span>&#x000A;516:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002702'>
                <a name='M002702'></a>
                <div class='synopsis'>
                  <span class='name'>directory</span>
                  <span class='arguments'>(relative_path)</span>
                </div>
                <div class='description'>
                  <p>
                  Remove each directory in the given path from right to left. Remove each
                  subdirectory if it exists and is a directory.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002702-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002702-source'>     <span class="ruby-comment cmt"># File vendor/rails/railties/lib/rails_generator/commands.rb, line 478</span>&#x000A;478:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">directory</span>(<span class="ruby-identifier">relative_path</span>)&#x000A;479:           <span class="ruby-identifier">parts</span> = <span class="ruby-identifier">relative_path</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">'/'</span>)&#x000A;480:           <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">empty?</span>&#x000A;481:             <span class="ruby-identifier">partial</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">parts</span>)&#x000A;482:             <span class="ruby-identifier">path</span> = <span class="ruby-identifier">destination_path</span>(<span class="ruby-identifier">partial</span>)&#x000A;483:             <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">path</span>)&#x000A;484:               <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Dir</span>[<span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">'*'</span>)].<span class="ruby-identifier">empty?</span>&#x000A;485:                 <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">rmdir</span> <span class="ruby-identifier">partial</span>&#x000A;486:                 <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:pretend</span>]&#x000A;487:                   <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:svn</span>]&#x000A;488:                     <span class="ruby-comment cmt"># If the directory has been marked to be added</span>&#x000A;489:                     <span class="ruby-comment cmt"># but has not yet been checked in, revert and delete</span>&#x000A;490:                     <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:svn</span>][<span class="ruby-identifier">relative_path</span>]&#x000A;491:                       <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;svn revert #{path}&quot;</span>)&#x000A;492:                       <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rmdir</span>(<span class="ruby-identifier">path</span>)&#x000A;493:                     <span class="ruby-keyword kw">else</span>&#x000A;494:                     <span class="ruby-comment cmt"># If the directory is not in the status list, it</span>&#x000A;495:                     <span class="ruby-comment cmt"># has no modifications so we can simply remove it</span>&#x000A;496:                       <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;svn rm #{path}&quot;</span>)&#x000A;497:                     <span class="ruby-keyword kw">end</span>&#x000A;498:                   <span class="ruby-comment cmt"># I don't think git needs to remove directories?..</span>&#x000A;499:                   <span class="ruby-comment cmt"># or maybe they have special consideration...</span>&#x000A;500:                   <span class="ruby-keyword kw">else</span>&#x000A;501:                     <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rmdir</span>(<span class="ruby-identifier">path</span>)&#x000A;502:                   <span class="ruby-keyword kw">end</span>&#x000A;503:                 <span class="ruby-keyword kw">end</span>&#x000A;504:               <span class="ruby-keyword kw">else</span>&#x000A;505:                 <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">notempty</span> <span class="ruby-identifier">partial</span>&#x000A;506:               <span class="ruby-keyword kw">end</span>&#x000A;507:             <span class="ruby-keyword kw">else</span>&#x000A;508:               <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">missing</span> <span class="ruby-identifier">partial</span>&#x000A;509:             <span class="ruby-keyword kw">end</span>&#x000A;510:             <span class="ruby-identifier">parts</span>.<span class="ruby-identifier">pop</span>&#x000A;511:           <span class="ruby-keyword kw">end</span>&#x000A;512:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002700'>
                <a name='M002700'></a>
                <div class='synopsis'>
                  <span class='name'>file</span>
                  <span class='arguments'>(relative_source, relative_destination, file_options = {})</span>
                </div>
                <div class='description'>
                  <p>
                  Remove a file if it exists and is a file.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002700-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002700-source'>     <span class="ruby-comment cmt"># File vendor/rails/railties/lib/rails_generator/commands.rb, line 433</span>&#x000A;433:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">file</span>(<span class="ruby-identifier">relative_source</span>, <span class="ruby-identifier">relative_destination</span>, <span class="ruby-identifier">file_options</span> = {})&#x000A;434:           <span class="ruby-identifier">destination</span> = <span class="ruby-identifier">destination_path</span>(<span class="ruby-identifier">relative_destination</span>)&#x000A;435:           <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-identifier">destination</span>)&#x000A;436:             <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">rm</span> <span class="ruby-identifier">relative_destination</span>&#x000A;437:             <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:pretend</span>]&#x000A;438:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:svn</span>]&#x000A;439:                 <span class="ruby-comment cmt"># If the file has been marked to be added</span>&#x000A;440:                 <span class="ruby-comment cmt"># but has not yet been checked in, revert and delete</span>&#x000A;441:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:svn</span>][<span class="ruby-identifier">relative_destination</span>]&#x000A;442:                   <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;svn revert #{destination}&quot;</span>)&#x000A;443:                   <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">destination</span>)&#x000A;444:                 <span class="ruby-keyword kw">else</span>&#x000A;445:                 <span class="ruby-comment cmt"># If the directory is not in the status list, it</span>&#x000A;446:                 <span class="ruby-comment cmt"># has no modifications so we can simply remove it</span>&#x000A;447:                   <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;svn rm #{destination}&quot;</span>)&#x000A;448:                 <span class="ruby-keyword kw">end</span>&#x000A;449:               <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:git</span>]&#x000A;450:                 <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:git</span>][<span class="ruby-identifier">:new</span>][<span class="ruby-identifier">relative_destination</span>]&#x000A;451:                   <span class="ruby-comment cmt"># file has been added, but not committed</span>&#x000A;452:                   <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;git reset HEAD #{relative_destination}&quot;</span>)&#x000A;453:                   <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">destination</span>)&#x000A;454:                 <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">:git</span>][<span class="ruby-identifier">:modified</span>][<span class="ruby-identifier">relative_destination</span>]&#x000A;455:                   <span class="ruby-comment cmt"># file is committed and modified</span>&#x000A;456:                   <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;git rm -f #{relative_destination}&quot;</span>)&#x000A;457:                 <span class="ruby-keyword kw">else</span>&#x000A;458:                   <span class="ruby-comment cmt"># If the directory is not in the status list, it</span>&#x000A;459:                   <span class="ruby-comment cmt"># has no modifications so we can simply remove it</span>&#x000A;460:                   <span class="ruby-identifier">system</span>(<span class="ruby-node">&quot;git rm #{relative_destination}&quot;</span>)&#x000A;461:                 <span class="ruby-keyword kw">end</span>&#x000A;462:               <span class="ruby-keyword kw">else</span>&#x000A;463:                 <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">rm</span>(<span class="ruby-identifier">destination</span>)&#x000A;464:               <span class="ruby-keyword kw">end</span>&#x000A;465:             <span class="ruby-keyword kw">end</span>&#x000A;466:           <span class="ruby-keyword kw">else</span>&#x000A;467:             <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">missing</span> <span class="ruby-identifier">relative_destination</span>&#x000A;468:             <span class="ruby-keyword kw">return</span>&#x000A;469:           <span class="ruby-keyword kw">end</span>&#x000A;470:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002704'>
                <a name='M002704'></a>
                <div class='synopsis'>
                  <span class='name'>migration_template</span>
                  <span class='arguments'>(relative_source, relative_destination, template_options = {})</span>
                </div>
                <div class='description'>
                  <p>
                  When deleting a migration, it knows to delete every file named
                  &#8220;[0-9]*_#{file_name}&#8221;.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002704-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002704-source'>     <span class="ruby-comment cmt"># File vendor/rails/railties/lib/rails_generator/commands.rb, line 519</span>&#x000A;519:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">migration_template</span>(<span class="ruby-identifier">relative_source</span>, <span class="ruby-identifier">relative_destination</span>, <span class="ruby-identifier">template_options</span> = {})&#x000A;520:           <span class="ruby-identifier">migration_directory</span> <span class="ruby-identifier">relative_destination</span>&#x000A;521: &#x000A;522:           <span class="ruby-identifier">migration_file_name</span> = <span class="ruby-identifier">template_options</span>[<span class="ruby-identifier">:migration_file_name</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">file_name</span>&#x000A;523:           <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">migration_exists?</span>(<span class="ruby-identifier">migration_file_name</span>)&#x000A;524:             <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;There is no migration named #{migration_file_name}&quot;</span>&#x000A;525:             <span class="ruby-keyword kw">return</span>&#x000A;526:           <span class="ruby-keyword kw">end</span>&#x000A;527: &#x000A;528: &#x000A;529:           <span class="ruby-identifier">existing_migrations</span>(<span class="ruby-identifier">migration_file_name</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file_path</span><span class="ruby-operator">|</span>&#x000A;530:             <span class="ruby-identifier">file</span>(<span class="ruby-identifier">relative_source</span>, <span class="ruby-identifier">file_path</span>, <span class="ruby-identifier">template_options</span>)&#x000A;531:           <span class="ruby-keyword kw">end</span>&#x000A;532:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002705'>
                <a name='M002705'></a>
                <div class='synopsis'>
                  <span class='name'>route_resources</span>
                  <span class='arguments'>(*resources)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002705-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002705-source'>     <span class="ruby-comment cmt"># File vendor/rails/railties/lib/rails_generator/commands.rb, line 534</span>&#x000A;534:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">route_resources</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">resources</span>)&#x000A;535:           <span class="ruby-identifier">resource_list</span> = <span class="ruby-identifier">resources</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_sym</span>.<span class="ruby-identifier">inspect</span> }.<span class="ruby-identifier">join</span>(<span class="ruby-value str">', '</span>)&#x000A;536:           <span class="ruby-identifier">look_for</span> = <span class="ruby-node">&quot;\n  map.resources #{resource_list}\n&quot;</span>&#x000A;537:           <span class="ruby-identifier">logger</span>.<span class="ruby-identifier">route</span> <span class="ruby-node">&quot;map.resources #{resource_list}&quot;</span>&#x000A;538:           <span class="ruby-identifier">gsub_file</span> <span class="ruby-value str">'config/routes.rb'</span>, <span class="ruby-node">/(#{look_for})/</span><span class="ruby-identifier">mi</span>, <span class="ruby-value str">''</span>&#x000A;539:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002701'>
                <a name='M002701'></a>
                <div class='synopsis'>
                  <span class='name'>template</span>
                  <span class='arguments'>(relative_source, relative_destination, file_options = {})</span>
                </div>
                <div class='description'>
                  <p>
                  Alias for <a href="Destroy.html#M002700">file</a>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
