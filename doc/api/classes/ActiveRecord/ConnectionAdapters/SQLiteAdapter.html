<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>: ActiveRecord::ConnectionAdapters::SQLiteAdapter [Rails Framework Documentation]</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          ActiveRecord::ConnectionAdapters::SQLiteAdapter
        </h1>
        <ol class='paths'>
          <li>
            <a href="../../../files/vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter_rb.html">vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="AbstractAdapter.html">ActiveRecord::ConnectionAdapters::AbstractAdapter</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            <p>
            The SQLite adapter works with both the 2.x and 3.x series of SQLite with
            the sqlite-ruby drivers (available both as gems and from <a
            href="http://rubyforge.org/projects/sqlite-ruby">rubyforge.org/projects/sqlite-ruby</a>/).
            </p>
            <p>
            Options:
            </p>
            <ul>
            <li><tt>:database</tt> - Path to the database file.
            
            </li>
            </ul>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M002288">new</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M002296">change_column_null</a></li>
              <li><a href="#M002292">disconnect!</a></li>
              <li><a href="#M002297">empty_insert_statement</a></li>
              <li><a href="#M002294">rename_table</a></li>
              <li><a href="#M002290">requires_reloading?</a></li>
              <li><a href="#M002293">select_rows</a></li>
              <li><a href="#M002291">supports_add_column?</a></li>
              <li><a href="#M002289">supports_ddl_transactions?</a></li>
              <li><a href="#M002295">valid_alter_table_options</a></li>
            </ol>
            <h3>protected instance</h3>
            <ol>
              <li><a href="#M002299">catch_schema_changes</a></li>
              <li><a href="#M002301">default_primary_key_type</a></li>
              <li><a href="#M002300">sqlite_version</a></li>
              <li><a href="#M002298">table_structure</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='class-list'>
              <h2>Classes and Modules</h2>
              Class <a href="SQLiteAdapter/Version.html" class="link">ActiveRecord::ConnectionAdapters::SQLiteAdapter::Version</a><br />
            </div>
            <div id='aliases-list'>
              <h2>External Aliases</h2>
              <div class='name-list'>
                <table summary='External aliases'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>remove_column</td>
                    <td>-&gt;</td>
                    <td class='context-item-value'>remove_columns</td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='method public-class' id='method-M002288'>
                <a name='M002288'></a>
                <div class='synopsis'>
                  <span class='name'>new</span>
                  <span class='arguments'>(connection, logger, config)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002288-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002288-source'>    <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 87</span>&#x000A;87:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">logger</span>, <span class="ruby-identifier">config</span>)&#x000A;88:         <span class="ruby-keyword kw">super</span>(<span class="ruby-identifier">connection</span>, <span class="ruby-identifier">logger</span>)&#x000A;89:         <span class="ruby-ivar">@config</span> = <span class="ruby-identifier">config</span>&#x000A;90:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='method public-instance' id='method-M002296'>
                <a name='M002296'></a>
                <div class='synopsis'>
                  <span class='name'>change_column_null</span>
                  <span class='arguments'>(table_name, column_name, null, default = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002296-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002296-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 272</span>&#x000A;272:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">change_column_null</span>(<span class="ruby-identifier">table_name</span>, <span class="ruby-identifier">column_name</span>, <span class="ruby-identifier">null</span>, <span class="ruby-identifier">default</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;273:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">null</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">default</span>.<span class="ruby-identifier">nil?</span>&#x000A;274:           <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;UPDATE #{quote_table_name(table_name)} SET #{quote_column_name(column_name)}=#{quote(default)} WHERE #{quote_column_name(column_name)} IS NULL&quot;</span>)&#x000A;275:         <span class="ruby-keyword kw">end</span>&#x000A;276:         <span class="ruby-identifier">alter_table</span>(<span class="ruby-identifier">table_name</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">definition</span><span class="ruby-operator">|</span>&#x000A;277:           <span class="ruby-identifier">definition</span>[<span class="ruby-identifier">column_name</span>].<span class="ruby-identifier">null</span> = <span class="ruby-identifier">null</span>&#x000A;278:         <span class="ruby-keyword kw">end</span>&#x000A;279:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002292'>
                <a name='M002292'></a>
                <div class='synopsis'>
                  <span class='name'>disconnect!</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002292-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002292-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 112</span>&#x000A;112:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">disconnect!</span>&#x000A;113:         <span class="ruby-keyword kw">super</span>&#x000A;114:         <span class="ruby-ivar">@connection</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>&#x000A;115:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002297'>
                <a name='M002297'></a>
                <div class='synopsis'>
                  <span class='name'>empty_insert_statement</span>
                  <span class='arguments'>(table_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002297-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002297-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 300</span>&#x000A;300:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">empty_insert_statement</span>(<span class="ruby-identifier">table_name</span>)&#x000A;301:         <span class="ruby-node">&quot;INSERT INTO #{table_name} VALUES(NULL)&quot;</span>&#x000A;302:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002294'>
                <a name='M002294'></a>
                <div class='synopsis'>
                  <span class='name'>rename_table</span>
                  <span class='arguments'>(name, new_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002294-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002294-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 237</span>&#x000A;237:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rename_table</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">new_name</span>)&#x000A;238:         <span class="ruby-identifier">execute</span> <span class="ruby-node">&quot;ALTER TABLE #{name} RENAME TO #{new_name}&quot;</span>&#x000A;239:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002290'>
                <a name='M002290'></a>
                <div class='synopsis'>
                  <span class='name'>requires_reloading?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002290-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002290-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 104</span>&#x000A;104:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">requires_reloading?</span>&#x000A;105:         <span class="ruby-keyword kw">true</span>&#x000A;106:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002293'>
                <a name='M002293'></a>
                <div class='synopsis'>
                  <span class='name'>select_rows</span>
                  <span class='arguments'>(sql, name = nil)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002293-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002293-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 174</span>&#x000A;174:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">select_rows</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>)&#x000A;175:         <span class="ruby-identifier">execute</span>(<span class="ruby-identifier">sql</span>, <span class="ruby-identifier">name</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>&#x000A;176:           (<span class="ruby-value">0</span><span class="ruby-operator">...</span>(<span class="ruby-identifier">row</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>)).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">i</span>] }&#x000A;177:         <span class="ruby-keyword kw">end</span>&#x000A;178:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002291'>
                <a name='M002291'></a>
                <div class='synopsis'>
                  <span class='name'>supports_add_column?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002291-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002291-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 108</span>&#x000A;108:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">supports_add_column?</span>&#x000A;109:         <span class="ruby-identifier">sqlite_version</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value str">'3.1.6'</span>&#x000A;110:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002289'>
                <a name='M002289'></a>
                <div class='synopsis'>
                  <span class='name'>supports_ddl_transactions?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002289-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002289-source'>    <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 96</span>&#x000A;96:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">supports_ddl_transactions?</span>&#x000A;97:         <span class="ruby-identifier">sqlite_version</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value str">'2.0.0'</span>&#x000A;98:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-M002295'>
                <a name='M002295'></a>
                <div class='synopsis'>
                  <span class='name'>valid_alter_table_options</span>
                  <span class='arguments'>( type, options)</span>
                </div>
                <div class='description'>
                  <p>
                  See: <a
                  href="http://www.sqlite.org/lang_altertable.html">www.sqlite.org/lang_altertable.html</a>
                  SQLite has an additional restriction on the ALTER TABLE statement
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002295-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002295-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 243</span>&#x000A;243:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">valid_alter_table_options</span>( <span class="ruby-identifier">type</span>, <span class="ruby-identifier">options</span>)&#x000A;244:         <span class="ruby-identifier">type</span>.<span class="ruby-identifier">to_sym</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">:primary_key</span>&#x000A;245:       <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Protected instance methods</h2>
              <div class='method protected-instance' id='method-M002299'>
                <a name='M002299'></a>
                <div class='synopsis'>
                  <span class='name'>catch_schema_changes</span>
                  <span class='arguments'>() {|| ...}</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002299-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002299-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 402</span>&#x000A;402:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">catch_schema_changes</span>&#x000A;403:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">yield</span>&#x000A;404:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">exception</span>&#x000A;405:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">exception</span>.<span class="ruby-identifier">message</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/database schema has changed/</span>&#x000A;406:             <span class="ruby-identifier">reconnect!</span>&#x000A;407:             <span class="ruby-keyword kw">retry</span>&#x000A;408:           <span class="ruby-keyword kw">else</span>&#x000A;409:             <span class="ruby-identifier">raise</span>&#x000A;410:           <span class="ruby-keyword kw">end</span>&#x000A;411:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M002301'>
                <a name='M002301'></a>
                <div class='synopsis'>
                  <span class='name'>default_primary_key_type</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002301-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002301-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 417</span>&#x000A;417:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">default_primary_key_type</span>&#x000A;418:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">supports_autoincrement?</span>&#x000A;419:             <span class="ruby-value str">'INTEGER PRIMARY KEY AUTOINCREMENT NOT NULL'</span>.<span class="ruby-identifier">freeze</span>&#x000A;420:           <span class="ruby-keyword kw">else</span>&#x000A;421:             <span class="ruby-value str">'INTEGER PRIMARY KEY NOT NULL'</span>.<span class="ruby-identifier">freeze</span>&#x000A;422:           <span class="ruby-keyword kw">end</span>&#x000A;423:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M002300'>
                <a name='M002300'></a>
                <div class='synopsis'>
                  <span class='name'>sqlite_version</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002300-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002300-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 413</span>&#x000A;413:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">sqlite_version</span>&#x000A;414:           <span class="ruby-ivar">@sqlite_version</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">SQLiteAdapter</span><span class="ruby-operator">::</span><span class="ruby-constant">Version</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'select sqlite_version(*)'</span>))&#x000A;415:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='method protected-instance' id='method-M002298'>
                <a name='M002298'></a>
                <div class='synopsis'>
                  <span class='name'>table_structure</span>
                  <span class='arguments'>(table_name)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M002298-source'); return false">
                    [show source]
                  </a>
                  <pre id='M002298-source'>     <span class="ruby-comment cmt"># File vendor/rails/activerecord/lib/active_record/connection_adapters/sqlite_adapter.rb, line 317</span>&#x000A;317:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">table_structure</span>(<span class="ruby-identifier">table_name</span>)&#x000A;318:           <span class="ruby-identifier">returning</span> <span class="ruby-identifier">structure</span> = <span class="ruby-identifier">execute</span>(<span class="ruby-node">&quot;PRAGMA table_info(#{quote_table_name(table_name)})&quot;</span>) <span class="ruby-keyword kw">do</span>&#x000A;319:             <span class="ruby-identifier">raise</span>(<span class="ruby-constant">ActiveRecord</span><span class="ruby-operator">::</span><span class="ruby-constant">StatementInvalid</span>, <span class="ruby-node">&quot;Could not find table '#{table_name}'&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">structure</span>.<span class="ruby-identifier">empty?</span>&#x000A;320:           <span class="ruby-keyword kw">end</span>&#x000A;321:         <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
